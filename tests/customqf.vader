Include: include/setup.vader

Execute (Displays custom formatted quickfix buffer):
  call neomake#quickfix#enable()
  call setloclist(0, [{
      \   'lnum': 1,
      \   'bufnr': 1,
      \   'text': 'Line 1 nmcfg:{"name": "Alpha", "short": "Alph"}',
      \ },
      \ {
      \   'lnum': 2,
      \   'col': 5,
      \   'bufnr': 1,
      \   'text': 'Line 2',
      \ }])

  lopen

  AssertEqual getline(1, '$'),
    \ ['Alph 1:- Line 1 ', 'Alph 2:5 Line 2']

  normal! 0
  " :normal! ignores autocmd's here?
  doautocmd CursorMoved
  AssertEqual expand('<cWORD>'), 'Line'
  AssertEqual getpos('.')[1:2], [1, 10]

  wincmd p

  " Test changing the location list while it's open
  call setloclist(0, [{
      \   'lnum': 1,
      \   'bufnr': 1,
      \   'text': 'Line 1 nmcfg:{"name": "Beta", "short": "Beta"}',
      \ },
      \ {
      \   'lnum': 2,
      \   'col': 5,
      \   'bufnr': 1,
      \   'text': 'Line 2',
      \ },
      \ {
      \   'lnum': 3,
      \   'bufnr': 1,
      \   'text': 'Line 3 nmcfg:{"name": "Gamma", "short": "Gamm"}',
      \ },
      \ {
      \   'lnum': 4,
      \   'col': 5,
      \   'bufnr': 1,
      \   'text': 'Line 4',
      \ }])

  wincmd p

  AssertEqual getline(1, '$'),
    \ ['Beta 1:- Line 1 ', 'Beta 2:5 Line 2',
    \  'Gamm 3:- Line 3 ', 'Gamm 4:5 Line 4']

  normal! G0
  doautocmd CursorMoved
  AssertEqual expand('<cWORD>'), 'Line'
  AssertEqual getpos('.')[1:2], [4, 10]

  close

Execute (Disable custom formatted quickfix buffer):
  Assert neomake#quickfix#is_enabled()
  call neomake#quickfix#disable()
  call setloclist(0, [{
      \   'lnum': 1,
      \   'bufnr': 1,
      \   'text': 'Line 1',
      \ },
      \ {
      \   'lnum': 2,
      \   'col': 5,
      \   'bufnr': 1,
      \   'text': 'Line 2',
      \ }])

  lopen

  AssertEqual getline(1, '$'),
    \ ['|1| Line 1', '|2 col 5| Line 2']

  normal! 0
  doautocmd CursorMoved
  AssertEqual expand('<cWORD>'), '|1|'
  AssertEqual getpos('.')[1:2], [1, 1]

  close
